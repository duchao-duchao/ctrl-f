!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self)["ctrl-f"]=t()}(this,(function(){"use strict";return new class{constructor(e={}){this.options={backgroundColor:"#fff",textColor:"#000",highlightColor:"yellow",searchBoxWidth:"96%",...e},this.createSearchBox(),this.listenForSearch(),this.clearHighlights()}createSearchBox(){if(this.searchBox)return;this.searchBox=document.createElement("div"),this.searchBox.style.position="fixed",this.searchBox.style.top="10px",this.searchBox.style.right="10px",this.searchBox.style.padding="10px",this.searchBox.style.backgroundColor=this.options.backgroundColor,this.searchBox.style.color=this.options.textColor,this.searchBox.style.boxShadow="0 2px 10px rgba(0, 0, 0, 0.1)",this.searchBox.style.zIndex="9999",this.searchBox.style.cursor="move",this.searchBox.style.width="376px";const e=document.createElement("input");e.type="text",e.placeholder="Search...",e.style.width=this.options.searchBoxWidth,e.style.padding="5px";const t=document.createElement("div");t.style.height="48px",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="space-between";const o=document.createElement("div");o.innerText="查找";const i=document.createElement("div");i.innerText="关闭",i.addEventListener("click",(()=>{this.closeSearchBox(),this.clearHighlights()})),t.appendChild(o),t.appendChild(i),this.searchBox.appendChild(t),this.searchBox.appendChild(e),document.body.appendChild(this.searchBox),e.addEventListener("input",(e=>{this.searchText(e.target.value)})),this.makeDraggable(this.searchBox)}closeSearchBox(){this.searchBox&&(document.body.removeChild(this.searchBox),this.searchBox=null)}clearHighlights(){document.querySelectorAll(".highlighted").forEach((e=>{const t=e.parentNode,o=[];let i=e.previousSibling;for(;i;)o.unshift(i),i=i.previousSibling;for(o.push(e),i=e.nextSibling;i;)o.push(i),i=i.nextSibling;const s=o.map((e=>e.textContent)).join(""),n=document.createTextNode(s);t?.replaceChildren(n)}))}searchText(e){if(this.clearHighlights(),!e.trim())return;const t=new RegExp(e,"gi");this.getTextNodesUnder(document.body).forEach((o=>{const i=o.textContent.match(t);i&&this.highlightText(o,i,e)}))}getTextNodesUnder(e){const t=[],o=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let i;for(;i=o.nextNode();)t.push(i);return t}highlightText(e,t,o){const i=new RegExp(`(${o})`,"gi"),s=e.textContent.split(i),n=e.parentNode,h=document.createDocumentFragment();s.forEach((e=>{if(e.toLowerCase()===o.toLowerCase()){const t=document.createElement("span");t.style.backgroundColor=this.options.highlightColor,t.style.fontWeight="bold",t.className="highlighted",t.textContent=e,h.appendChild(t)}else h.appendChild(document.createTextNode(e))})),n.replaceChild(h,e)}listenForSearch(){window.addEventListener("keydown",(e=>{e.ctrlKey&&"f"===e.key&&(e.preventDefault(),this.createSearchBox())}))}makeDraggable(e){let t,o,i=!1;e.addEventListener("mousedown",(s=>{i=!0,t=s.clientX-e.getBoundingClientRect().left,o=s.clientY-e.getBoundingClientRect().top})),window.addEventListener("mousemove",(s=>{i&&(e.style.top=s.clientY-o+"px",e.style.left=s.clientX-t+"px")})),window.addEventListener("mouseup",(()=>{i=!1}))}}}));
